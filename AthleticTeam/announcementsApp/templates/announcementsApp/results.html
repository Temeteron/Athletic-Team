{% extends "announcementsApp/container.html" %}

{% block head %}
{% load staticfiles %}
  <title>Results</title>
  <link rel="stylesheet" type="text/css" href="{% static 'announcementsApp/css/style.css' %}" />
  <script type="text/javascript" src="{% static 'announcementsApp/js/myscript.js' %}"></script> 
{% endblock %}


{% block container %}
    <h1>Current announcement with his comments and votes</h1>
    <h2>Title : {{ announcement.announcement_title}}</h2>
    <p>{{ announcement.announcement_text }}</p>
    <p>Published by {{ announcement.owner }}</p>
    <hr>

    <h3>Comments</h3>
    <ul>
    {% for comment in announcement.comment_set.all %}
        <li>{{ comment.comment_text }} -- {{ comment.votes }} vote{{ comment.votes|pluralize }} -- By: {{ comment.owner }}</li>
        <hr>
    {% endfor %}
    </ul>

    <h3>Delete one of your comments</h3>
    <!-- Make possible a deletion of a comment -->
    <form action="{% url 'announcementsApp:delete' announcement.id %}" method="post">
        {% for comment in announcement.comment_set.all %}
            {% csrf_token %}
            {% ifequal user comment.owner %} 
                <input type="radio" name="comment" id="comment{{ forloop.counter }}" value="{{ comment.id }}" />
                <label for="comment{{ forloop.counter }}">{{ comment.comment_text }}</label>
            {% endifequal %}         
        {% endfor %}
        <br />
        {% if error_message %}<p><strong>{{ error_message }}</strong></p>{% endif %}
        <input type="submit" name="delete" value="Delete comment" class="btn btn-success" />
    </form>  
    <br />
    <p><a href="{% url 'announcementsApp:detail' announcement.id %}">Vote a comment or make one</a></p>
    <p><a href="{% url 'announcementsApp:index' %}">Go to recent announcements</a></p>
{% endblock %}
